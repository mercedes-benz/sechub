// SPDX-License-Identifier: MIT
package com.daimler.sechub.sereco.metadata;

import java.util.ArrayList;
import java.util.List;
import java.util.Objects;

import com.daimler.sechub.commons.model.ScanType;

public class SerecoVulnerability {

    private String url;
    private String type;

    private SerecoSeverity severity;
    private List<SerecoDetection> list;
    private String description = "";
    SerecoClassification classification;
    SerecoCodeCallStackElement code;
    private String productResultLink;
    private ScanType scanType;

    private boolean falsePositive;
    private String falsePositiveReason;

    public SerecoVulnerability() {
        severity = SerecoSeverity.UNCLASSIFIED;
        list = new ArrayList<>();
        classification = new SerecoClassification();
    }

    /**
     * Only for tests
     *
     * @param url
     * @param type
     * @param severity
     * @param list
     * @param description
     * @param classification
     */
    SerecoVulnerability(String url, String type, SerecoSeverity severity, List<SerecoDetection> list, String description, SerecoClassification classification) {
        super();
        this.url = url;
        this.type = type;
        this.severity = severity;
        this.list = list;
        this.description = description;
        this.classification = classification;
    }

    public void setFalsePositiveReason(String falsePositiveReason) {
        this.falsePositiveReason = falsePositiveReason;
    }

    public String getFalsePositiveReason() {
        return falsePositiveReason;
    }

    public void setFalsePositive(boolean markedAsFalsePositiveInProduct) {
        this.falsePositive = markedAsFalsePositiveInProduct;
    }

    public boolean isFalsePositive() {
        return falsePositive;
    }

    public void setScanType(ScanType scanType) {
        this.scanType = scanType;
    }

    public ScanType getScanType() {
        return scanType;
    }

    public void setCode(SerecoCodeCallStackElement code) {
        this.code = code;
    }

    /**
     *
     * @return code info or <code>null</code> when not existing
     */
    public SerecoCodeCallStackElement getCode() {
        return code;
    }

    public String getDescription() {
        return description;
    }

    public SerecoClassification getClassification() {
        return classification;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public SerecoSeverity getSeverity() {
        return severity;
    }

    public void setSeverity(SerecoSeverity severity) {
        this.severity = severity;

        if (this.severity == null) {
            this.severity = SerecoSeverity.UNCLASSIFIED;
        }
    }

    public void setList(List<SerecoDetection> list) {
        this.list = list;
    }

    public List<SerecoDetection> getList() {
        return list;
    }

    public void setProductResultLink(String productResultLink) {
        this.productResultLink = productResultLink;
    }

    public String getProductResultLink() {
        return productResultLink;
    }

    @Override
    public int hashCode() {
        return Objects.hash(classification, code, description, list, productResultLink, severity, type, url);
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        SerecoVulnerability other = (SerecoVulnerability) obj;
        return Objects.equals(classification, other.classification) && Objects.equals(code, other.code) && Objects.equals(description, other.description)
                && Objects.equals(list, other.list) && Objects.equals(productResultLink, other.productResultLink) && severity == other.severity
                && Objects.equals(type, other.type) && Objects.equals(url, other.url);
    }

    @Override
    public String toString() {
        return "Vulnerability [falsePositive=" + falsePositive + ", url=" + url + ", type=" + type + ", severity=" + severity + ", list=" + list
                + ", description=" + description + ", classification=" + classification + ", codeInfo=" + code + ", productResultLink=" + productResultLink
                + "]";
    }

}
