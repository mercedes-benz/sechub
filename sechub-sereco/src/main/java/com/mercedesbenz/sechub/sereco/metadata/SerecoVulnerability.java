// SPDX-License-Identifier: MIT
package com.mercedesbenz.sechub.sereco.metadata;

import java.util.ArrayList;
import java.util.List;
import java.util.Objects;

import com.mercedesbenz.sechub.commons.model.ScanType;

public class SerecoVulnerability {

    private String type;

    private SerecoSeverity severity;
    private List<SerecoDetection> list;
    private String description = "";
    private String solution;

    SerecoClassification classification;
    SerecoCodeCallStackElement code;
    SerecoWeb web;

    private String productResultLink;
    private ScanType scanType;

    private boolean falsePositive;
    private String falsePositiveReason;

    private SerecoRevisionData revision;

    public SerecoVulnerability() {
        severity = SerecoSeverity.UNCLASSIFIED;
        list = new ArrayList<>();
        classification = new SerecoClassification();
    }

    /*
     * Only for tests
     */
    SerecoVulnerability(String type, SerecoSeverity severity, List<SerecoDetection> list, String description, SerecoClassification classification) {
        super();
        this.type = type;
        this.severity = severity;
        this.list = list;
        this.description = description;
        this.classification = classification;
    }

    public void setFalsePositiveReason(String falsePositiveReason) {
        this.falsePositiveReason = falsePositiveReason;
    }

    public String getFalsePositiveReason() {
        return falsePositiveReason;
    }

    public void setFalsePositive(boolean markedAsFalsePositiveInProduct) {
        this.falsePositive = markedAsFalsePositiveInProduct;
    }

    public boolean isFalsePositive() {
        return falsePositive;
    }

    public void setScanType(ScanType scanType) {
        this.scanType = scanType;
    }

    public ScanType getScanType() {
        return scanType;
    }

    public void setCode(SerecoCodeCallStackElement code) {
        this.code = code;
    }

    /**
     *
     * @return code info or <code>null</code> when not existing
     */
    public SerecoCodeCallStackElement getCode() {
        return code;
    }

    public String getDescription() {
        return description;
    }

    public String getSolution() {
        return solution;
    }

    public void setSolution(String solution) {
        this.solution = solution;
    }

    public SerecoClassification getClassification() {
        return classification;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public SerecoSeverity getSeverity() {
        return severity;
    }

    public void setSeverity(SerecoSeverity severity) {
        this.severity = severity;

        if (this.severity == null) {
            this.severity = SerecoSeverity.UNCLASSIFIED;
        }
    }

    public void setList(List<SerecoDetection> list) {
        this.list = list;
    }

    public List<SerecoDetection> getList() {
        return list;
    }

    public void setProductResultLink(String productResultLink) {
        this.productResultLink = productResultLink;
    }

    public String getProductResultLink() {
        return productResultLink;
    }

    public void setWeb(SerecoWeb web) {
        this.web = web;
    }

    /**
     * @return web data or <code>null</code> if not available (e.g. when it is a
     *         code scan)
     */
    public SerecoWeb getWeb() {
        return web;
    }

    public SerecoRevisionData getRevision() {
        return revision;
    }

    public void setRevision(SerecoRevisionData revision) {
        this.revision = revision;
    }

    @Override
    public int hashCode() {
        return Objects.hash(classification, code, description, list, productResultLink, severity, type, web);
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        SerecoVulnerability other = (SerecoVulnerability) obj;
        return Objects.equals(classification, other.classification) && Objects.equals(code, other.code) && Objects.equals(description, other.description)
                && Objects.equals(list, other.list) && Objects.equals(productResultLink, other.productResultLink) && severity == other.severity
                && Objects.equals(type, other.type) && Objects.equals(web, other.web);
    }

    @Override
    public String toString() {
        return "SerecoVulnerability [" + (scanType != null ? "scanType=" + scanType + ", " : "") + (type != null ? "type=" + type + ", " : "")
                + (description != null ? "description=" + description + ", " : "") + (severity != null ? "severity=" + severity + ", " : "")
                + (classification != null ? "classification=" + classification + ", " : "") + (web != null ? "web=" + web : "") + "]";
    }

}
