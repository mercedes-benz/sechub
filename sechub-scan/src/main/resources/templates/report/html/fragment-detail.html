<th:block th:fragment="groupedDetail(secHubFindingList, webScanMap, trafficLightLowerCased, headlineCountMainText)">
    <div th:if="${not #lists.isEmpty(secHubFindingList) or not #maps.isEmpty(webScanMap)}">
            <h2 th:class="${trafficLightLowerCased}+'FindingHeadline'" th:id="${trafficLightLowerCased}+'FindingsBlock'" th:text="${headlineCountMainText} + ' (Count: ' + ${#lists.size(redList)} + ')'"/>
            <div th:if="${not secHubFindingList.?[type == T(com.mercedesbenz.sechub.commons.model.ScanType).CODE_SCAN].isEmpty()}">
                <span th:id="${trafficLightLowerCased}+'CodeScanTable'"/>
                <div th:replace="report/html/fragment-generic-scan-table :: scanTable(scanType = 'Code Scan', tableClass = ${trafficLightLowerCased}+'FindingsTable',findingList = ${secHubFindingList})"></div>
            </div>
            <div th:if="${not secHubFindingList.?[type == T(com.mercedesbenz.sechub.commons.model.ScanType).INFRA_SCAN].isEmpty()}">
                <span th:id="${trafficLightLowerCased}+'InfraScanTable'"/>
                <div th:replace="report/html/fragment-generic-scan-table :: scanTable(scanType = 'Infra Scan', tableClass = ${trafficLightLowerCased}+'FindingsTable',findingList = ${secHubFindingList})"></div>
            </div>
            <div th:if="${not secHubFindingList.?[type == T(com.mercedesbenz.sechub.commons.model.ScanType).SECRET_SCAN].isEmpty()}">
                <span th:id="${trafficLightLowerCased}+'SecretScanTable'"/>
                <div th:replace="report/html/fragment-generic-scan-table :: scanTable(scanType = 'Secret Scan', tableClass = ${trafficLightLowerCased}+'FindingsTable',findingList = ${secHubFindingList})"></div>
            </div>
            <div th:if="${not #maps.isEmpty(webScanMap)}">
                <span th:id="${trafficLightLowerCased}WebScanTable"/>
                <h2 class='scanTypeHeadline'>Web Scan</h2>
                <table th:class="'findingsTable '+${trafficLightLowerCased}+'FindingsTable'">
                    <thead>
                    <tr>
                        <th style="width:5%">Severity</th>
                        <th style="width:20%">Type</th>
                        <th>Description</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="findingEntry : ${webScanMap}">
                        <div th:replace="report/html/fragment-web-scan-table :: scanTable"></div>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
</th:block>
        
        