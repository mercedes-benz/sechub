<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SecHub scan result</title>
    <!--/*
        Remark: This comments will be removed at thymeleaf parsing time - means not in HTML output

        Important: If you change scanresult.css please always start HTMLReportCSSFragementGenerator to
                   synch to the fragment part. Details see HTMLReportCSSFragementGenerator.java

    */-->
    <link th:if="${isWebDesignMode}" th:href="${includedCSSRef}"
          rel="stylesheet" type="text/css" href="scanresult.css">
    <style type="text/css" th:if="!${isWebDesignMode}"
           th:replace="report/html/fragment-generic-scan-table :: styles">
    </style>
</head>
<body>
	<div class="sidenav">
	    <div class="trafficlight">
	        <div class="protector"></div>
	        <div class="protector"></div>
	        <div class="protector"></div>
	        <div class="red" th:style="${styleRed}" style="opacity: 1.0"></div>
	        <div class="yellow" th:style="${styleYellow}" style="opacity: 0.25"></div>
	        <div class="green" th:style="${styleGreen}" style="opacity: 0.25"></div>
	    </div>
	</div>
	<div class="main">
	    <div class="header">
	        <table>
	            <tr>
	                <td>
	                     <!--/*                   
		                ---------------------------------
		                -      SecHub shield logo       -
		                ---------------------------------
	                   */-->
	                    <div class="logo">
	                        <!--
	                             Link: <https://www.iconfinder.com/icons/1034363/advantage_protect_protection_security_shield_icon#size=128>
	                             License: "Free for commercial use
	                          -->
	                        <svg enable-background="new 0 0 64 64" version="1.1"
	                             viewBox="0 0 64 64" xml:space="preserve"
	                             xmlns="http://www.w3.org/2000/svg"
	                             xmlns:xlink="http://www.w3.org/1999/xlink">
				                <g id="row_4"/>
	                            <g id="row_3"/>
	                            <g id="row_2"/>
	                            <g id="row_1">
				                <g id="protection">
				                <path
	                                    d="M55.7,9.3C50.4,4.2,43.1,2,32,2S13.6,4.2,8.3,9.3L8,9.6v20.6V32c0,13.7,9.5,25.9,23.7,30.3l0.3,0.1    l0.3-0.1C46.5,57.9,56,45.7,56,32V9.6L55.7,9.3z"
	                                    fill="#FFCA28"/>
	                                <path
	                                        d="M49.8,12.5C45.9,9.5,40.2,8.2,32,8.2v47.8l0.2-0.1C43,51.9,50,42.5,50,32V12.6L49.8,12.5z"
	                                        fill="#FFECB3"/>
	                                <path
	                                        d="M14.2,12.5L14,12.6V32c0,10.5,7,19.9,17.8,23.9l0.2,0.1V8.2C23.8,8.2,18.1,9.5,14.2,12.5z"
	                                        fill="#FFF8E1"/>
	                                <polygon fill="#4CAF50"
	                                         points="30.4,43.2 20.4,29.2 23.6,26.8 31.5,37.9 40.2,17.2 43.8,18.8 33.8,42.8   "/></g></g></svg>
	                    </div>
	                </td>
	                <td class="logotitle">SecHub</td>
	            </tr>
	            <tr class="reportsubtitle">
	                <td></td>
	                <td>Scan result Report for Job:<span th:text="${jobuuid}">job-uuid</span>
	                </td>
	            </tr>
	            <!--/*                   
	                ---------------------------------
	                -            Labels             -
	                ---------------------------------
	            */-->
	            <tr class="reportlabels" th:if="${metaData!=null && !metaData.get().getLabels().isEmpty()}">
	                <td></td>
	                <td>
	                    <table class='reportMetaDataTable'>
	                        <tr th:each="entry : ${metaData.get().getLabels()}">
	                            <td class="metaDataLabelKey" th:text="${entry.key}">key</td>
	                            <td class="metaDataLabelValue" th:text="${entry.value}">value</td>
	                        </tr>
	                    </table>
	                </td>
	            </tr>
	        </table>
	    </div>
	    <div class="content">
	
	        <div th:if="!${scanTypeCountSet.isEmpty()}">
	            <h2 class='summaryHeadline'>Summary</h2>
	            <!--/*                   
	                ---------------------------------
	                -            Summary            -
	                ---------------------------------
	            */-->
	            <table class='summaryTable'>
	                <thead>
	                <tr>
	                    <th></th>
	                    <th>Total</th>
	                    <th>Critical</th>
	                    <th>High</th>
	                    <th>Medium</th>
	                    <th>Low</th>
	                    <th>Unclassified</th>
	                    <th>Info</th>
	                </tr>
	                </thead>
	                <tbody>
	                <tr th:each="scanTypeCount : ${scanTypeCountSet}">
	                <!--/* 
	                   Next fragment line renders summary row for each contained scan type.
	                   An example:
	                   
	                            Total  Critical High  Medium   Low   Unclassified Info
	                   Web scan   1     0        1       0       0       0          0
	                   
	                   */-->
	                    <div th:replace="report/html/fragment-summary :: summaryTableRow"></div>
	                </tr>
	                </tbody>
	            </table>
	        </div>
	        <!--/*                   
	             ---------------------------------
	             - Summary scan type detail data -
	             - as overview for scan types    -
	             - e.g. Web Scan overview > ...  -
	             ---------------------------------
	         */-->
	        <div th:if="${metaData!=null}">
	            <div th:replace="report/html/fragment-summary :: summaryDetail(${metaData.get().getSummary().getCodeScan()},'Code scan overview')"></div>
	            <div th:replace="report/html/fragment-summary :: summaryDetail(${metaData.get().getSummary().getInfraScan()},'Infra scan overview')"></div>
	            <div th:replace="report/html/fragment-summary :: summaryDetail(${metaData.get().getSummary().getLicenseScan()},'License scan overview')"></div>
	            <div th:replace="report/html/fragment-summary :: summaryDetail(${metaData.get().getSummary().getSecretScan()},'Secret scan overview')"></div>
	            <div th:replace="report/html/fragment-summary :: summaryDetail(${metaData.get().getSummary().getWebScan()},'Web scan overview')"></div>
	        </div>
	        <!--/*                   
	             ---------------------------------
	             - Render details grouped:       -
	             - RED, YELLOW, GREEN            -
	             ---------------------------------
	         */-->
	        <div th:replace="report/html/fragment-detail :: groupedDetail(redHTMLSecHubFindingList,redHTMLWebScanMap, 'red', 'Red findings' )"></div>
	        <div th:replace="report/html/fragment-detail :: groupedDetail(yellowHTMLSecHubFindingList,yellowHTMLWebScanMap, 'yellow', 'Yellow findings' )"></div>
	        <div th:replace="report/html/fragment-detail :: groupedDetail(greenHTMLSecHubFindingList,greenHTMLWebScanMap, 'green', 'Green findings' )"></div>
	         <!--/*                   
	             ---------------------------------
	             - Render messages               -
	             ---------------------------------
	         */-->
	        <div class="messages" th:if="${messages!=null && !messages.isEmpty()}">
		        <h2 class='messagesHeadline'>Messages</h2>
		        <table class='messagesTable'>
		            <tbody>
		            <tr th:each="message : ${messages}">
		                <td th:utext="${reportHelper.getMessageTypeAsHTMLIcon(message.type)}">ðŸ›‡</td>
		                <td th:text="${message.text}">This is an error message text</td>
		            </tr>
		            <tr th:remove="all">
		                <td>âš </td>
		                <td>This is a warning message text</td>
		            </tr>
		            <tr th:remove="all">
		                <td>ðŸ›ˆ</td>
		                <td>This is an info message text</td>
		            </tr>
		            <tr th:remove="all">
		                <td></td>
		                <td>This is a message where message type is null</td>
		            </tr>
		            </tbody>
		        </table>
		    </div>
		 </div>
	</div>
</body>
</html>